local a=require"widgets/imagebutton"local b=require"screens/redux/popupdialog"local c='local player = %s if player == nil then ThePlayer.components.talker:Say("'..STRINGS.TOO_MANY_ITEMS_UI.PLAYER_NOT_ON_SLAVE_TIP..'") return end 'local function d()local e=1;local f=TheInput:IsKeyDown(KEY_CTRL)if f then e=0 end;local g='local h = player.components.hunger if player and not player:HasTag("playerghost") and h then h:SetPercent('..e..") end"SendCommand(string.format(c..g,GetCharacter()))OperateAnnnounce(STRINGS.TOO_MANY_ITEMS_UI.BUTTON_HUNGER)end;local function h()local e=1;local f=TheInput:IsKeyDown(KEY_CTRL)if f then e=0 end;local g='local h = player.components.sanity if player and not player:HasTag("playerghost") and h then h:SetPercent('..e..") end"SendCommand(string.format(c..g,GetCharacter()))OperateAnnnounce(STRINGS.TOO_MANY_ITEMS_UI.BUTTON_SANITY)end;local function i()local e=1;local f=TheInput:IsKeyDown(KEY_CTRL)if f then e=0.05 end;local g='local h = player.components.health if player and not player:HasTag("playerghost") and h then h:SetPercent('..e..") end"SendCommand(string.format(c..g,GetCharacter()))OperateAnnnounce(STRINGS.TOO_MANY_ITEMS_UI.BUTTON_HEALTH)end;local function j()local k=STRINGS.TOO_MANY_ITEMS_UI.BUTTON_HEALTHLOCK..":"local l=k..STRINGS.UI.MODSSCREEN.STATUS.WORKING_NORMALLY;local m=k..STRINGS.UI.MODSSCREEN.STATUS.DISABLED_MANUAL;local g='local h = player.components.health local t = player.components.talker local hpper = h:GetPercent() local minhp = h.minhealth local hv if player and not player:HasTag("playerghost") and h then if minhp == 0 then hv = 1 t:Say("'..l..'") elseif minhp == 1 then hv = 0 t:Say("'..m..'") else hv = 0 t:Say("'..m..'") end h:SetMinHealth(hv) h:SetPercent(hpper) end'SendCommand(string.format(c..g,GetCharacter()))end;local function n()local e=0;local f=TheInput:IsKeyDown(KEY_CTRL)if f then e=1 end;local g='local h = player.components.moisture if player and not player:HasTag("playerghost") and h then h:SetPercent('..e..") end"SendCommand(string.format(c..g,GetCharacter()))OperateAnnnounce(STRINGS.TOO_MANY_ITEMS_UI.BUTTON_WET)end;local function o()local e=25;local f=TheInput:IsKeyDown(KEY_CTRL)if f and TheWorld and TheWorld.state.temperature then e=TheWorld.state.temperature end;local g='local h = player.components.temperature if player and not player:HasTag("playerghost") and h then h:SetTemperature('..e..") end"SendCommand(string.format(c..g,GetCharacter()))OperateAnnnounce(STRINGS.TOO_MANY_ITEMS_UI.BUTTON_TEMPERATURE)end;local function p()local q=STRINGS.TOO_MANY_ITEMS_UI.TMIP_CONSOLE;local r=STRINGS.TOO_MANY_ITEMS_UI.BUTTON_GODMODE..":"local s=r..STRINGS.UI.MODSSCREEN.STATUS.DISABLED_MANUAL;local t=r..STRINGS.UI.MODSSCREEN.STATUS.WORKING_NORMALLY;local g='local p = player local h = p.components.health local t = p.components.talker if p ~= nil then if p:HasTag("playerghost") then p:PushEvent("respawnfromghost") p.rezsource = "'..q..'" else if h ~= nil then local godmode = h.invincible t:Say(godmode and "'..s..'" or "'..t..'") h:SetInvincible(not godmode) end end end'SendCommand(string.format(c..g,GetCharacter()))end;local function u()local v=STRINGS.TOO_MANY_ITEMS_UI.BUTTON_CREATIVEMODE..":"local w=v..STRINGS.UI.MODSSCREEN.STATUS.DISABLED_MANUAL;local x=v..STRINGS.UI.MODSSCREEN.STATUS.WORKING_NORMALLY;local g='local p = player local b = p.components.builder local t = p.components.talker if p and b and t then t:Say(b.freebuildmode and "'..w..'" or "'..x..'") b:GiveAllRecipes() end'SendCommand(string.format(c..g,GetCharacter()))end;local function y()local z=STRINGS.TOO_MANY_ITEMS_UI.BUTTON_ONEHITKILLMODE..":"local A=z..STRINGS.UI.MODSSCREEN.STATUS.DISABLED_MANUAL;local B=z..STRINGS.UI.MODSSCREEN.STATUS.WORKING_NORMALLY;local g='local p = player local c = p.components.combat or nil local t = p.components.talker if p and c and t and c.CalcDamage then if c.OldCalcDamage then p.components.talker:Say("'..A..'") c.CalcDamage = c.OldCalcDamage c.OldCalcDamage = nil else p.components.talker:Say("'..B..'") c.OldCalcDamage = c.CalcDamage c.CalcDamage = function(...) return 9999999999*9 end end end'SendCommand(string.format(c..g,GetCharacter()))end;local function C()if _G.TOOMANYITEMS.DATA.SHOW_CONFIRM_SCREEN then local D;D=b(STRINGS.TOO_MANY_ITEMS_UI.BUTTON_EMPINVENTORY,STRINGS.TOO_MANY_ITEMS_UI.BUTTON_EMPINVENTORYTIP,{{text=STRINGS.UI.TRADESCREEN.ACCEPT,cb=function()local f=TheInput:IsKeyDown(KEY_CTRL)local E=0;if f then E=1 end;local g="local inventory = player and player.components.inventory or nil local backpack = inventory and inventory:GetOverflowContainer() or nil local inventorySlotCount = inventory and inventory:GetNumSlots() or 0 local backpackSlotCount = backpack and backpack:GetNumSlots() or 0 local removeallinstr = "..E.." for i = 1, inventorySlotCount do local item = inventory:GetItemInSlot(i) or nil inventory:RemoveItem(item, true) if item ~= nil then item:Remove() end end if removeallinstr == 1 then for i = 1, backpackSlotCount do local item = backpack:GetItemInSlot(i) or nil inventory:RemoveItem(item, true) if item ~= nil then item:Remove() end end end"SendCommand(string.format(c..g,GetCharacter()))TheFrontEnd:PopScreen(D)end},{text=STRINGS.UI.TRADESCREEN.CANCEL,cb=function()TheFrontEnd:PopScreen(D)end}})TheFrontEnd:PushScreen(D)else local f=TheInput:IsKeyDown(KEY_CTRL)local E=0;if f then E=1 end;local g="local inventory = player and player.components.inventory or nil local backpack = inventory and inventory:GetOverflowContainer() or nil local inventorySlotCount = inventory and inventory:GetNumSlots() or 0 local backpackSlotCount = backpack and backpack:GetNumSlots() or 0 local removeallinstr = "..E.." for i = 1, inventorySlotCount do local item = inventory:GetItemInSlot(i) or nil inventory:RemoveItem(item, true) if item ~= nil then item:Remove() end end if removeallinstr == 1 then for i = 1, backpackSlotCount do local item = backpack:GetItemInSlot(i) or nil inventory:RemoveItem(item, true) if item ~= nil then item:Remove() end end end"SendCommand(string.format(c..g,GetCharacter()))end end;local function F()if _G.TOOMANYITEMS.DATA.SHOW_CONFIRM_SCREEN then local D;D=b(STRINGS.TOO_MANY_ITEMS_UI.BUTTON_EMPTYBACKPACK,STRINGS.TOO_MANY_ITEMS_UI.BUTTON_EMPTYBACKPACKTIP,{{text=STRINGS.UI.TRADESCREEN.ACCEPT,cb=function()local f=TheInput:IsKeyDown(KEY_CTRL)local E=0;if f then E=1 end;local g="local inventory = player and player.components.inventory or nil local backpack = inventory and inventory:GetOverflowContainer() or nil local inventorySlotCount = inventory and inventory:GetNumSlots() or 0 local backpackSlotCount = backpack and backpack:GetNumSlots() or 0 local removeallinstr = "..E.." for i = 1, backpackSlotCount do local item = backpack:GetItemInSlot(i) or nil inventory:RemoveItem(item, true) if item ~= nil then item:Remove() end end if removeallinstr == 1 then for i = 1, inventorySlotCount do local item = inventory:GetItemInSlot(i) or nil inventory:RemoveItem(item, true) if item ~= nil then item:Remove() end end end"SendCommand(string.format(c..g,GetCharacter()))TheFrontEnd:PopScreen(D)end},{text=STRINGS.UI.TRADESCREEN.CANCEL,cb=function()TheFrontEnd:PopScreen(D)end}})TheFrontEnd:PushScreen(D)else local f=TheInput:IsKeyDown(KEY_CTRL)local E=0;if f then E=1 end;local g="local inventory = player and player.components.inventory or nil local backpack = inventory and inventory:GetOverflowContainer() or nil local inventorySlotCount = inventory and inventory:GetNumSlots() or 0 local backpackSlotCount = backpack and backpack:GetNumSlots() or 0 local removeallinstr = "..E.." for i = 1, backpackSlotCount do local item = backpack:GetItemInSlot(i) or nil inventory:RemoveItem(item, true) if item ~= nil then item:Remove() end end if removeallinstr == 1 then for i = 1, inventorySlotCount do local item = inventory:GetItemInSlot(i) or nil inventory:RemoveItem(item, true) if item ~= nil then item:Remove() end end end"SendCommand(string.format(c..g,GetCharacter()))end end;local G=Class(function(self,H,I)self.owner=H;self.shield=self.owner.owner.shield;local J=-180;local K=-220;local function L()self.owner.owner:Close()end;local function M()self.owner.owner:ShowDebugMenu()end;local function N()self.owner.owner:ShowWoodieMenu()end;local function O()self.owner.owner:ShowAbigailMenu()end;self.menu={["hunger"]={tip=STRINGS.TOO_MANY_ITEMS_UI.BUTTON_HUNGER,fn=d,atlas="images/customicobyysh.xml",image="tmipbutton_hunger.tex",pos={I[1],J}},["sanity"]={tip=STRINGS.TOO_MANY_ITEMS_UI.BUTTON_SANITY,fn=h,atlas="images/customicobyysh.xml",image="tmipbutton_sanity.tex",pos={I[2],J}},["health"]={tip=STRINGS.TOO_MANY_ITEMS_UI.BUTTON_HEALTH,fn=i,atlas="images/customicobyysh.xml",image="tmipbutton_health.tex",pos={I[3],J}},["lockhealth"]={tip=STRINGS.TOO_MANY_ITEMS_UI.BUTTON_HEALTHLOCK..STRINGS.TOO_MANY_ITEMS_UI.BUTTON_ONOROFF,fn=j,atlas="images/customicobyysh.xml",image="tmipbutton_health_lock.tex",pos={I[4],J}},["moisture"]={tip=STRINGS.TOO_MANY_ITEMS_UI.BUTTON_WET,fn=n,atlas="images/customicobyysh.xml",image="tmipbutton_wet.tex",pos={I[5],J}},["temperature"]={tip=STRINGS.TOO_MANY_ITEMS_UI.BUTTON_TEMPERATURE,fn=o,atlas="images/customicobyysh.xml",image="tmipbutton_temperature.tex",pos={I[6],J}},["cancel"]={tip=STRINGS.UI.OPTIONS.CLOSE,fn=L,atlas="images/customicobyysh.xml",image="tmipbutton_close.tex",pos={I[8],J}},["prevbutton"]={tip=STRINGS.UI.HELP.PREVPAGE,fn=function()self.owner.inventory:Scroll(-1)end,atlas="images/customicobyysh.xml",image="tmipbutton_left.tex",pos={I[9],J}},["nextbutton"]={tip=STRINGS.UI.HELP.NEXTPAGE,fn=function()self.owner.inventory:Scroll(1)end,atlas="images/customicobyysh.xml",image="tmipbutton_right.tex",pos={I[10],J}},["woodiemenu"]={tip=STRINGS.TOO_MANY_ITEMS_UI.BUTTON_SUBMENU_WOODIEMENU,fn=N,atlas="images/customicobyysh.xml",image="tmipbutton_woodie.tex",pos={I[1],K}},["abigailmenu"]={tip=STRINGS.TOO_MANY_ITEMS_UI.BUTTON_SUBMENU_ABIGAIL,fn=O,atlas="images/customicobyysh.xml",image="tmipbutton_abigail.tex",pos={I[2],K}},["creativemode"]={tip=STRINGS.TOO_MANY_ITEMS_UI.BUTTON_CREATIVEMODE..STRINGS.TOO_MANY_ITEMS_UI.BUTTON_ONOROFF,fn=u,atlas="images/customicobyysh.xml",image="tmipbutton_creativemode.tex",pos={I[3],K}},["godmode"]={tip=STRINGS.TOO_MANY_ITEMS_UI.BUTTON_GODMODE..STRINGS.TOO_MANY_ITEMS_UI.BUTTON_ONOROFF,fn=p,atlas="images/customicobyysh.xml",image="tmipbutton_godmode.tex",pos={I[4],K}},["onehitkillmode"]={tip=STRINGS.TOO_MANY_ITEMS_UI.BUTTON_ONEHITKILLMODE..STRINGS.TOO_MANY_ITEMS_UI.BUTTON_ONOROFF,fn=y,atlas="images/customicobyysh.xml",image="tmipbutton_onehitkillmode.tex",pos={I[5],K}},["removeinventory"]={tip=STRINGS.TOO_MANY_ITEMS_UI.BUTTON_EMPINVENTORY,fn=C,atlas="images/customicobyysh.xml",image="tmipbutton_empinventory.tex",pos={I[6],K}},["removebackpack"]={tip=STRINGS.TOO_MANY_ITEMS_UI.BUTTON_EMPTYBACKPACK,fn=F,atlas="images/customicobyysh.xml",image="tmipbutton_empbackpack.tex",pos={I[7],K}},["debug"]={tip=STRINGS.TOO_MANY_ITEMS_UI.BUTTON_DEBUGMENU..STRINGS.TOO_MANY_ITEMS_UI.BUTTON_ONOROFF,fn=M,atlas="images/customicobyysh.xml",image="tmipbutton_debugmod.tex",pos={I[8],K}}}self:MainButton()end)function G:MainButton()self.mainbuttons={}local function P(Q)local function R(S,T,U,V,W,I)if type(W)=="string"then self.mainbuttons[S]=self.shield:AddChild(a(V,W,W,W))elseif type(W)=="table"then self.mainbuttons[S]=self.shield:AddChild(a(V,W[1],W[2],W[3]))else return end;self.mainbuttons[S]:SetTooltip(T)self.mainbuttons[S]:SetOnClick(U)self.mainbuttons[S]:SetPosition(I[1],I[2],0)local X,Y=self.mainbuttons[S].image:GetSize()local Z=math.min(35/X,35/Y)self.mainbuttons[S]:SetNormalScale(Z)self.mainbuttons[S]:SetFocusScale(Z*1.1)end;for _,a0 in pairs(Q)do R(_,a0.tip,a0.fn,a0.atlas,a0.image,a0.pos)end end;if self.menu then P(self.menu)self.mainbuttons["removebackpack"]:SetImageNormalColour(1,0.9,0.9,0.9)self.mainbuttons["removebackpack"]:SetImageFocusColour(1,0.1,0.1,0.9)self.mainbuttons["removebackpack"]:SetImageSelectedColour(1,0,0,0.9)self.mainbuttons["removeinventory"]:SetImageNormalColour(1,0.9,0.9,0.9)self.mainbuttons["removeinventory"]:SetImageFocusColour(1,0.1,0.1,0.9)self.mainbuttons["removeinventory"]:SetImageSelectedColour(1,0,0,0.9)end end;return G
